<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>Laboratório — Integração com Banco de Dados (Java + JDBC)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --fg:#1b1f23; --muted:#5f6a79; --bg:#ffffff; --code:#0b1021; --border:#e6e8eb; }
    html,body { margin:0; padding:0; background:var(--bg); color:var(--fg); font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"; }
    .page { max-width: 920px; margin: 32px auto; padding: 0 20px 64px; }
    h1 { font-size: 1.9rem; margin: 0 0 8px; }
    h2 { font-size: 1.4rem; margin: 28px 0 8px; border-top:1px solid var(--border); padding-top:18px; }
    h3 { font-size: 1.1rem; margin: 20px 0 8px; }
    p, li { color: var(--fg); }
    code, pre { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    pre { background:#f6f8fa; border:1px solid var(--border); border-radius:6px; padding:12px; overflow:auto; }
    code { background:#f6f8fa; border:1px solid var(--border); border-radius:4px; padding:2px 4px; }
    .note { color: var(--muted); }
    ul { padding-left: 22px; }
    hr { border:0; border-top:1px solid var(--border); margin:24px 0; }
    .print { font-size: 0.95rem; background:#fff8e1; border:1px solid #ffe0a3; padding:10px 12px; border-radius:6px; }
  </style>
</head>
<body>
  <main class="page">
    <h1>Laboratório — Integração com Banco de Dados (Java + JDBC)</h1>
    <p class="print"><strong>Dica de impressão:</strong> Abra este arquivo no navegador e use “Imprimir &gt; Salvar como PDF”.</p>

    <h2>1) Pré‑requisitos</h2>
    <ul>
      <li>Java 17+ (<code>java -version</code>)</li>
      <li>Maven 3.8+ (<code>mvn -version</code>)</li>
      <li>Opcional: DB Browser for SQLite (para inspecionar <code>loja.db</code>)</li>
    </ul>

    <h2>2) Obter e compilar o projeto</h2>
    <ul>
      <li>Entre na pasta <code>lab-jdbc</code>.</li>
      <li>Compile:</li>
    </ul>
    <pre><code>mvn -q -DskipTests package</code></pre>
    <p>Se compilar sem erros, o ambiente está ok.</p>

    <h2>3) Banco de dados</h2>
    <ul>
      <li>O arquivo do banco (SQLite) é <code>loja.db</code>, criado no diretório do projeto.</li>
      <li>A conexão (<code>ConexaoDB</code>) habilita <code>PRAGMA foreign_keys = ON</code> para respeitar FKs.</li>
    </ul>

    <h2>4) Execução dos exercícios (passo a passo)</h2>
    <p>Use o Exec Plugin do Maven e troque o nome da classe conforme indicado.</p>

    <h3>Exercício 1 — “Hello, DB!”</h3>
    <p>Objetivo: abrir/fechar conexão com SQLite.</p>
    <pre><code>mvn -q exec:java -Dexec.mainClass=com.profluizricardomantovani.labjdbc.ConexaoDB</code></pre>
    <p><strong>Validação:</strong> “Conexão estabelecida!” e arquivo <code>loja.db</code> criado.</p>

    <h3>Exercício 2 — Criar esquema (DDL)</h3>
    <p>Objetivo: criar tabelas <code>clientes</code> e <code>pedidos</code>.</p>
    <pre><code>mvn -q exec:java -Dexec.mainClass=com.profluizricardomantovani.labjdbc.CriaSchema</code></pre>
    <p><strong>Validação:</strong> “Tabelas criadas/validadas com sucesso.”</p>

    <h3>Exercício 3 — Inserção segura (PreparedStatement + batch)</h3>
    <p>Objetivo: inserir clientes com parâmetros.</p>
    <pre><code>mvn -q exec:java -Dexec.mainClass=com.profluizricardomantovani.labjdbc.InsereClientes</code></pre>
    <p><strong>Validação:</strong> “Clientes inseridos com sucesso.”</p>

    <h3>Exercício 4 — SELECT com filtros e ordenação</h3>
    <p>Objetivo: ler e exibir no console.</p>
    <pre><code>mvn -q exec:java -Dexec.mainClass=com.profluizricardomantovani.labjdbc.ListaClientes</code></pre>
    <p><strong>Validação:</strong> linhas no formato <code>[id] Nome &lt;email&gt;</code> (até 10, nomes iniciando com M).</p>

    <h3>Exercício 5 — UPDATE e DELETE com segurança</h3>
    <p>Objetivo: atualizar telefone e remover cliente com WHERE.</p>
    <pre><code>mvn -q exec:java -Dexec.mainClass=com.profluizricardomantovani.labjdbc.AtualizaCliente
mvn -q exec:java -Dexec.mainClass=com.profluizricardomantovani.labjdbc.RemoveCliente</code></pre>
    <p><strong>Validação:</strong> “Linhas atualizadas: X” e “Linhas removidas: Y” (X/Y ≥ 0). Confirme com o Exercício 4.</p>

    <h3>Exercício 6 — Transações (commit/rollback)</h3>
    <p>Objetivo: inserir cliente + pedido na mesma transação.</p>
    <pre><code>mvn -q exec:java -Dexec.mainClass=com.profluizricardomantovani.labjdbc.PedidoTransacional</code></pre>
    <p><strong>Validação:</strong> “Transação confirmada.”</p>
    <p><strong>Desafio:</strong> force um erro entre as etapas e observe o rollback (nenhuma das inserções deve persistir após <code>rollback()</code>).</p>

    <h3>Exercício 8 (Bônus) — Mini-DAO de Cliente</h3>
    <p>Objetivo: encapsular acesso a dados (CRUD básico). Arquivos: <code>model/Cliente</code>, <code>dao/ClienteDAO</code>, <code>MainDAO</code>.</p>
    <pre><code>mvn -q exec:java -Dexec.mainClass=com.profluizricardomantovani.labjdbc.CriaSchema
mvn -q exec:java -Dexec.mainClass=com.profluizricardomantovani.labjdbc.MainDAO</code></pre>
    <p><strong>Validação:</strong> saída mostrando salvar → listar → buscar → atualizar → remover.</p>

    <h2>5) Testes rápidos (checagens de saída)</h2>
    <ul>
      <li>Conexão: “Conexão estabelecida!”.</li>
      <li>Schema: “Tabelas criadas/validadas com sucesso.”</li>
      <li>Inserção: “Clientes inseridos com sucesso.”</li>
      <li>Listagem: ao menos um <code>[id] Nome &lt;email&gt;</code>.</li>
      <li>Update/Delete: mensagens de linhas afetadas e listagem coerente.</li>
      <li>Transação: “Transação confirmada.” (e, no cenário de erro, nada persistido após rollback).</li>
    </ul>

    <h2>6) Entregáveis sugeridos (para alunos)</h2>
    <ul>
      <li>Ex. 0: print do <code>pom.xml</code> (dependência SQLite) + build concluído.</li>
      <li>Ex. 1: print com “Conexão estabelecida!”.</li>
      <li>Ex. 2: print da execução (opcional: esquema no DB Browser).</li>
      <li>Ex. 3: print da inserção + listagem do Ex. 4.</li>
      <li>Ex. 4: print da listagem.</li>
      <li>Ex. 5: prints de UPDATE/DELETE + listagem confirmando.</li>
      <li>Ex. 6: prints de commit e do caso com erro/rollback.</li>
      <li>Ex. 8 (bônus): projeto com DAO e execução do <code>MainDAO</code>.</li>
    </ul>

    <h2>7) Rubrica de avaliação (sugestão)</h2>
    <ul>
      <li>Projeto compila e roda (10%).</li>
      <li>Esquema com FK corretamente (15%).</li>
      <li>Inserção segura com PreparedStatement e transação (20%).</li>
      <li>Consultas com filtros/ordenação e impressão correta (15%).</li>
      <li>UPDATE/DELETE com boas práticas (20%).</li>
      <li>Transações commit/rollback funcionando (20%).</li>
    </ul>

    <h2>8) Dicas e problemas comuns</h2>
    <ul>
      <li>Dependência JDBC ausente/errada no <code>pom.xml</code>.</li>
      <li>Caminho do SQLite: use <code>jdbc:sqlite:./loja.db</code> (relativo ao projeto).</li>
      <li>Sempre use <code>PreparedStatement</code> e <code>WHERE</code> para UPDATE/DELETE.</li>
      <li>Feche recursos com try-with-resources (como no código).</li>
      <li>Para inspecionar o DB graficamente, use DB Browser for SQLite e abra <code>loja.db</code>.</li>
    </ul>

    <h2>9) Estrutura do projeto</h2>
    <pre><code>lab-jdbc/
  pom.xml
  README.md
  .gitignore
  roteiro-lab.html
  src/main/java/
    com/profluizricardomantovani/labjdbc/
      ConexaoDB.java
      CriaSchema.java
      InsereClientes.java
      ListaClientes.java
      AtualizaCliente.java
      RemoveCliente.java
      PedidoTransacional.java
      MainDAO.java
    com/profluizricardomantovani/labjdbc/dao/ClienteDAO.java
    com/profluizricardomantovani/labjdbc/model/Cliente.java</code></pre>

    <p class="note">Site da aula: profluizricardomantovani.com/aula-6-integracao-banco-dados</p>
  </main>
</body>
</html>

